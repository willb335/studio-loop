---
/**
 * FAQ component - Objection handler with accordion interface
 * 
 * Addresses critical questions and objections from potential users.
 * Implements accordion pattern for expandable Q&A sections.
 * Designed to build trust and overcome common concerns.
 * 
 * @see docs/OBJECTION_HANDLER_FAQ.md - Source content
 * @see docs/LANDING_PAGE_OPTIMIZATION_STRATEGY.md - Implementation strategy (lines 369-432)
 */

/**
 * FAQ data structure containing questions and detailed answers
 * Each item includes a question, answer, and category for organization
 */
const faqs = [
  {
    id: "fitgrid-difference",
    question: "How is this different from FitGrid?",
  answer: `We built StudioLoop after running FitGrid in our own studios and hearing the same frustrations from boutique owners.

- **Pricing sanity:** Lock in $29/mo versus FitGrid's $169–$325/mo. That's 80–90% less every month—$1,800–$3,552 in annual savings.
- **No feature bloat:** We obsess over two outcomes—automated post-class follow-ups and instructor feedback—so you aren't paying for SMS, AI segmentation, or enterprise controls you may never launch.
- **Instructor happiness:** Templates live in a clean web app. No 2.4-star mobile app or buggy push notifications. We're intentional about user experience so their workflow feels effortless.

If FitGrid already delivers at $300/month, keep it. If you want the same retention lift with an improved UX at a tenth of the price, that's us.`,
    category: "product",
  },
  {
    id: "mindbody-integration",
    question: "Do I need to switch from Mindbody?",
  answer: `You keep Mindbody. StudioLoop is designed to sit on top of it without changing your daily workflow.

- We're working with Mindbody to deliver a true single sign-on. If that isn't available, we'll set up the initial API connection with you for free so it stays secure and painless.
- Automatic roster, instructor, and first-timer sync every 15 minutes keeps everything current.
- Follow-ups and feedback go out within an hour of each class, no staff action required.

No exports, no duplicate data entry, no new dashboards for your team to babysit.`,
    category: "technical",
  },
//   {
//     id: "setup-time",
//     question: "How long does setup really take?",
//   answer: `Most studios go live the same day.

// - Pick a default follow-up template (we preload the top-performing copy).
// - Connect Mindbody, choose which classes to automate, and set send windows.
// - Preview the first email and flip the switch.
// - Once instructors sign in to their content portals and set their follow-up templates, the owner dashboard updates instantly.

// Member review emails send automatically—no extra setup. Total time: about five minutes. Need help? We hop on Zoom and do it with you.`,
//     category: "product",
//   },
  {
    id: "instructor-adoption",
    question: "Will my instructors actually use this?",
  answer: `Yes—because they barely have to touch it.

- Instructors set a template email once in a simple web view and can forget it.
- StudioLoop sends every follow-up automatically, branded per instructor.

No new app to download, no inboxes to manage, no nagging required.`,
    category: "product",
  },
  {
    id: "pricing-catch",
    question: "If it's so much cheaper than FitGrid, what's the catch?",
  answer: `Launch pricing stays low because we're focused.

- **Included at $29/mo:** Automated post-class emails, feedback collection, open/click analytics, instructor template library, and the Mindbody sync.
- **Transparent approach:** We don't market mysterious AI or magic dashboards, and we currently integrate with Mindbody only so we are focused on only one integration.

No contracts, setup fees, or hidden per-email charges.`,
    category: "pricing",
  },
  {
    id: "proof-of-effectiveness",
    question: "How do I know this actually works?",
  answer: `We're using a tactic that's already proven.

- FitGrid's own case studies report 35–46% more first-time clients returning when instructors send a follow-up.
- Those same clients spend 87% more in the first 90 days compared with people who never got an email.

We'll share anonymized cohort data (open rates, revenue impact, retention curves) before you commit.`,
    category: "results",
  },
  {
    id: "data-security",
    question: "Is my member data secure?",
  answer: `Absolutely. Security is non-negotiable for us.

- StudioLoop runs on Convex, a zero-trust backend platform that handles authentication, rate limiting, and encrypted storage out of the box.
- Mindbody data travels over encrypted channels and is stored using Convex's SOC 2-type controls, so you get enterprise-grade protections without extra setup.
`,
    category: "risk",
  },
  {
    id: "launch-timeline",
    question: "When do I get access—and what comes with the beta?",
  answer: `We're aiming for 20 studios in the beta cohort.

- Once the first 20 sign up, we'll start building the full app and keep you updated on launch milestones.
- Those first 20 studios get two months free and direct input on the roadmap.

Join the waitlist and we'll reserve your spot while we prep the build.`,
    category: "product",
  },
  {
    id: "money-back-guarantee",
    question: "What if I don't see results?",
    answer: `Zero risk.

- Month-to-month billing—you can cancel anytime.
- **60-day money-back guarantee:** if your engagement metrics don't improve, we refund you 100%.
- We help you benchmark before and after so there's no fuzzy math.

If we can't move the needle for your studio, you shouldn't pay for it.`,
    category: "risk",
  }
];
---

<section id="faq" class="bg-white py-16 sm:py-20 lg:py-28" aria-labelledby="faq-heading">
  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-10 sm:mb-14 lg:mb-16">
      <div class="inline-flex items-center justify-center px-3 py-1 mb-4 text-xs font-medium rounded-full bg-rose-100 text-rose-700">
        Limited Beta - 20 spots left
      </div>
      <h2 id="faq-heading" class="font-heading text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900 mb-4 sm:mb-5 leading-tight">
        Your Questions, Honestly Answered
      </h2>
      <p class="font-body text-base sm:text-lg lg:text-xl text-neutral-600 leading-relaxed max-w-2xl mx-auto">
        We're building this in public with you. Ask the hard questions—we'll answer them straight so you can decide with data, not hype.
      </p>
    </div>

    <!-- FAQ Accordion -->
    <div class="space-y-3 sm:space-y-4" role="list" aria-label="Frequently asked questions">
      {faqs.map((faq) => (
        <article
          class="faq-item border border-neutral-200 rounded-lg sm:rounded-xl overflow-hidden transition-all duration-200"
          data-faq-id={faq.id}
          role="listitem"
        >
          <button
            type="button"
            class="faq-button w-full text-left px-5 sm:px-6 lg:px-7 py-5 sm:py-6 flex items-start justify-between gap-3 sm:gap-4 hover:bg-neutral-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-neutral-300 focus:ring-inset"
            aria-expanded="false"
            aria-controls={`faq-answer-${faq.id}`}
            data-faq-button="true"
          >
            <span class="font-heading text-base sm:text-lg lg:text-xl font-semibold text-neutral-900 pr-2 sm:pr-4 leading-snug">
              {faq.question}
            </span>
            <svg
              class="faq-icon flex-shrink-0 w-5 h-5 sm:w-6 sm:h-6 mt-0.5 transition-transform duration-300 ease-out"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2.5"
              aria-hidden="true"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          
          <div
            id={`faq-answer-${faq.id}`}
            class="faq-answer overflow-hidden transition-all duration-300 ease-out"
            style="max-height: 0;"
            aria-hidden="true"
            data-faq-answer="true"
          >
            <div class="px-5 sm:px-6 lg:px-7 pb-5 sm:pb-6 pt-1">
              <div class="font-body text-sm sm:text-base lg:text-lg text-neutral-600 leading-relaxed prose prose-neutral max-w-none
                [&>p]:mb-3 sm:[&>p]:mb-4 
                [&>ul]:ml-5 sm:[&>ul]:ml-6 
                [&>ul]:list-disc 
                [&>ul]:space-y-1.5 sm:[&>ul]:space-y-2 
                [&>ul]:mb-3 sm:[&>ul]:mb-4 
                [&_strong]:text-neutral-900 
                [&_strong]:font-semibold
                [&>p:last-child]:mb-0
                [&>ul:last-child]:mb-0">
                {faq.answer.split('\n\n').map((block: string) => {
                  // Check if this block is a list
                  if (block.trim().startsWith('-')) {
                    const items = block.split('\n').filter((line: string) => line.trim().startsWith('-'));
                    return (
                      <ul>
                        {items.map((item: string) => (
                          <li set:html={item.replace(/^-\s*/, '').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')} />
                        ))}
                      </ul>
                    );
                  }
                  // Regular paragraph
                  const formatted = block
                    .trim()
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                  return formatted ? <p set:html={formatted} /> : null;
                })}
              </div>
            </div>
          </div>
        </article>
      ))}
    </div>

    <!-- Bottom CTA -->
    <div class="mt-10 sm:mt-14 lg:mt-16 text-center">
      <p class="font-body text-sm sm:text-base lg:text-lg text-neutral-600 mb-5 sm:mb-6">
        Still on the fence? Book a quick call with us after you join—we'll walk through your numbers together.
      </p>
      <button
        id="faq-cta-button"
        class="inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 text-white text-sm sm:text-base lg:text-lg font-semibold rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-rose-400 focus:ring-offset-2 cursor-pointer bg-rose-500 hover:bg-rose-600 shadow-lg shadow-rose-200/60"
        aria-label="Get early access and join the waitlist"
      >
        Get Early Access – Save $1,800/yr
      </button>
    </div>
  </div>
</section>

<script>
/**
 * FAQ accordion interaction logic and CTA button handler
 * Handles expanding/collapsing FAQ items with smooth animations
 * Mobile-optimized for touch interactions
 */
document.addEventListener('DOMContentLoaded', () => {
  // FAQ accordion logic
  const faqButtons = document.querySelectorAll('[data-faq-button]');
  
  faqButtons.forEach((button) => {
    button.addEventListener('click', () => {
      const faqItem = button.closest('.faq-item');
      const answer = faqItem?.querySelector('[data-faq-answer]');
      const icon = button.querySelector('.faq-icon');
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      
      if (!answer || !icon) return;
      
      // Close all other FAQs
      document.querySelectorAll('.faq-item').forEach((item) => {
        if (item !== faqItem) {
          const otherButton = item.querySelector('[data-faq-button]') as HTMLButtonElement | null;
          const otherAnswer = item.querySelector('[data-faq-answer]') as HTMLElement | null;
          const otherIcon = item.querySelector('.faq-icon') as HTMLElement | null;

          if (otherButton && otherAnswer && otherIcon) {
            otherButton.setAttribute('aria-expanded', 'false');
            otherAnswer.setAttribute('aria-hidden', 'true');
            otherAnswer.style.maxHeight = '0';
            otherIcon.style.transform = 'rotate(0deg)';
            item.classList.remove('faq-open');
          }
        }
      });
      
      // Toggle current FAQ
      const answerEl = answer as HTMLElement;
      const iconEl = icon as HTMLElement;

      if (isExpanded) {
        button.setAttribute('aria-expanded', 'false');
        answerEl.setAttribute('aria-hidden', 'true');
        answerEl.style.maxHeight = '0';
        iconEl.style.transform = 'rotate(0deg)';
        faqItem?.classList.remove('faq-open');
      } else {
        button.setAttribute('aria-expanded', 'true');
        answerEl.setAttribute('aria-hidden', 'false');
        // Add extra space for smooth animation
        answerEl.style.maxHeight = `${answerEl.scrollHeight + 20}px`;
        iconEl.style.transform = 'rotate(180deg)';
        faqItem?.classList.add('faq-open');
      }
    });
  });
  
  // CTA button handler
  const ctaButton = document.getElementById('faq-cta-button');
  if (ctaButton) {
    ctaButton.style.backgroundColor = 'rgb(244, 63, 94)';
    ctaButton.addEventListener('click', () => {
      const waitlistSection = document.getElementById('waitlist');
      if (waitlistSection) {
        waitlistSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
    
    // Hover effects (desktop only)
    if (window.matchMedia('(hover: hover)').matches) {
      ctaButton.addEventListener('mouseenter', () => {
        ctaButton.style.backgroundColor = 'rgb(225, 29, 72)';
        ctaButton.style.transform = 'translateY(-2px)';
      });
      
      ctaButton.addEventListener('mouseleave', () => {
        ctaButton.style.backgroundColor = 'rgb(244, 63, 94)';
        ctaButton.style.transform = 'translateY(0)';
      });
    }
    
    // Active state for mobile
    ctaButton.addEventListener('touchstart', () => {
      ctaButton.style.backgroundColor = 'rgb(225, 29, 72)';
    });
    
    ctaButton.addEventListener('touchend', () => {
      setTimeout(() => {
        ctaButton.style.backgroundColor = 'rgb(244, 63, 94)';
      }, 150);
    });
  }
});
</script>

<style>
  /**
   * Mobile-first FAQ component styles
   * Smooth animations and professional appearance
   */
  
  /* Smooth transition for FAQ answer expansion */
  .faq-answer {
    transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Icon rotation with smooth easing */
  .faq-icon {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    color: rgb(244, 63, 94);
  }

  /* Clean, neutral styling for FAQ items - no pink accents on container */
  .faq-item {
    border-color: rgb(229, 231, 235);
    background-color: transparent;
  }

  .faq-item:hover {
    border-color: rgb(209, 213, 219);
  }

  .faq-item.faq-open {
    border-color: rgb(209, 213, 219);
    background-color: rgb(249, 250, 251);
  }

  /* Button styling */
  .faq-button {
    background-color: transparent;
    -webkit-tap-highlight-color: transparent;
  }

  .faq-button:hover {
    background-color: rgb(249, 250, 251);
  }

  .faq-button:focus-visible {
    outline: 2px solid rgb(209, 213, 219);
    outline-offset: -2px;
  }

  /* Mobile touch optimization */
  @media (max-width: 640px) {
    .faq-button {
      padding-top: 1.25rem;
      padding-bottom: 1.25rem;
    }
    
    .faq-button:active {
      background-color: rgb(243, 244, 246);
    }
  }

  /* CTA button smooth transitions */
  #faq-cta-button {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Ensure proper spacing for last paragraph/list in answers */
  .faq-answer p:last-child,
  .faq-answer ul:last-child {
    margin-bottom: 0;
  }

  /* Better text rendering on mobile */
  @media (max-width: 640px) {
    .faq-button span {
      font-size: 1rem;
      line-height: 1.5;
    }
    
    .faq-answer {
      font-size: 0.875rem;
      line-height: 1.6;
    }
  }

  /* Improve tap targets for accessibility */
  .faq-button {
    min-height: 44px;
  }

  /* Smooth color transitions */
  .faq-item {
    transition: all 0.2s ease-out;
  }
</style>